code updated to fit feature and bugfix plus Feature C