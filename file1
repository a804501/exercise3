code updated to fit feature and bugfix